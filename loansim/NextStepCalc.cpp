#include <vector>
#include "NextStepCalc.h"
#include <iostream>

using namespace std;

const cof1 NextStepCalcML::P_L1_NSK_I_NP = {3.7632325,0,0,0.2469034,0.2582373,0.2644602,0.8352045,0.1523489,0.0863273,0,0.0043855,0,0.0230587,0.028021,0,0,-0.2204341,0.2312649,0.0072996,0,0.0450588,0,0,-0.0246381,0.1495776,0.3247662,0,0};
const cof1 NextStepCalcML::P_L1_NSK_NI_NP = {12.469201,1.0444037,0.55617,-1.5218012,-0.18201,0.0602407,1.1012467,0.7528763,0.2046414,0,0.0059754,-0.0065431,0.0203576,0.0592174,-0.0042877,0,-0.5097858,0,-0.0168926,0,0,0,0,0,0,0,0,0};
const cof1 NextStepCalcML::P_L1_NSK_I_P = {4.7326955,0.7746075,0.0708825,0.4988439,0.4260029,-0.1702626,0.4418371,-0.0094021,0.2574415,0.2233992,0,0,0.0321942,0.0534435,-0.00181,0,-0.3029986,0.1918936,0.0212404,0.3303345,0.0666013,-0.0337265,0,0,0,0,0,0};
const cof1 NextStepCalcML::P_L1_NSK_NI_P = {12.18518,0.280456,-0.418831,0.082843,0.562431,0.660932,0.942235,0.416415,-0.087973,0,0,0,0.014457,0.068496,-0.006672,0,-0.699726,0.284656,-0.02361,0.359116,0.142387,0,0,-0.169889,0.310209,0.444477,0,0};
const cof1 NextStepCalcML::P_L1_SK_I_NP = {3.2984208,0.5370123,0.3596594,-0.7674193,-0.8617903,0.5605103,0.639125,-0.0792252,0.18979,0.2184801,0.0252654,-0.0017683,0.0203708,0.043978,0,0,-0.123043,0.1817891,0,0,0.1840467,-0.0307838,0.0690674,0.0458889,-0.035989,0.1228306,0,0};
const cof1 NextStepCalcML::P_L1_SK_NI_NP = {6.7952062,0.2847023,0.4344127,-2.5110645,-2.6333268,0.4588798,1.295803,0.7276331,0.1121705,0.1880673,0.0093982,0,0.0195109,0.0336841,-0.0026548,0,-0.4323666,0,0.0149934,0,0,0,0,-0.1001393,0.2583211,0.2424037,0.381736445,0};
const cof1 NextStepCalcML::P_L1_SK_I_P = {2.5004266,1.2672734,0.0898834,-1.0694729,-1.5193926,0.8505788,0.9645844,-0.2594774,-0.113187,0.1024268,0,0,0.0281123,0,-0.0011378,0,-0.1418623,0,0.0089118,0.8801181,0.2328023,-0.0664458,0.2071039,0,0,0,0.220117052,0};
const cof1 NextStepCalcML::P_L1_SK_NI_P = {2.06870229,0,0,0,0,0,0,0.19308052,-0.19387338,0,0,0,0,0.05597881,0,0,0,0,-0.00694634,1.18018245,0.31552213,0,0,-0.73073708,-0.05091552,-0.1047801,0.271523152,0};
const cof1 NextStepCalcML::P_L2_NSK_I_NP = {9.1568056,0,0,10.935546,-1.1245884,0,0,-0.4778343,0.0820934,-0.2879653,0,-0.0082748,0,0.0598688,-0.0045408,0,-0.0378654,0,0.0238687,0,0.1447396,-0.0544991,0,0,0,0,0,1.4581956};
const cof1 NextStepCalcML::P_L2_NSK_NI_NP = {11.51064,0,0,11.04822,-2.61088,0,0,-2.40096,-0.86598,0,0,0,0,0.1918,0,0,-0.98145,-0.55325,0,0,0,0.11606,0,0,0,0,0.4225491,0};
const cof1 NextStepCalcML::P_L2_NSK_I_P = {9.6572193,0,0,-0.1992836,-1.9172313,0.144802,1.0479023,-0.7602387,-0.062292,-0.6312971,0,-0.0069021,0,0.1210102,-0.0059411,0,0,0,0.0360214,0,0.0994907,-0.0441451,1.5376005,-0.0304299,0.0026997,0.7176693,0,1.205963};
const cof1 NextStepCalcML::P_L2_NSK_NI_P = {14.7129769,0,0,-1.560234,-3.0087606,0.076867,-1.361418,0,0,0,0,0,-0.0113605,0,-0.0093978,0,0,0,0,0,0,0.188883,3.3422776,0,0,0,0,0};
const cof1 NextStepCalcML::P_L2_SK_I_NP = {7.570963,0,0,0.973399,-2.489706,-0.247241,0.819012,0.132654,1.591358,0,0.030507,-0.018082,-0.016963,0.06465,0,0,0.14661,0,0,0,0.179578,-0.353993,3.521733,-1.114561,-0.275327,-0.121455,0,2.64955};
const cof1 NextStepCalcML::P_L2_SK_NI_NP = {19.657453,0,0,0,0,0,0,-0.440958,-0.433886,0,0.032809,0,0.01147,0,-0.013975,0,0,0,-0.073004,0,0,0,0.288581,-0.308084,0.104266,0.222744,0,0};
const cof1 NextStepCalcML::P_L2_SK_I_P = {13.7744247,0,0,0,0,0,0,0,0,0,-0.0542377,-0.0162967,0.0139858,0.1784351,-0.0044527,0,-0.3933687,0,0,0,0,0,0,-2.0909463,-0.2372905,0.325121,0.209004033,1.5918346};
const cof1 NextStepCalcML::P_L2_SK_NI_P = {10.572009,0,0,0,0,-1.147165,-2.12655,0,0,0,0,0,0.010258,0,-0.016784,0,0,0.846616,0,-0.431713,0,-0.173351,0,1.924221,1.804567,2.07702,0.53126629,0};
const cof1 NextStepCalcML::NP_2YR = {-4.25402794,0,0,0.33456572,0.36938283,0.08171585,0.21711833,0,0,0.28643644,0,0,0.02376798,0,-0.0052831,0,0.13021626,0,0,1.78743213,0,0.0364785,-0.01984955,-0.0208501,0.04081789,0.17738434,0,0};
const cof1 NextStepCalcML::NP_3YR = {-2.9966186,0,0,0.3462371,0.2813221,0,0,-0.0773588,-0.2175076,0.2942711,0,0,0.0168258,0,-0.0047801,0,0.1658608,0,-0.0174222,1.1354906,0.0418566,0.0473915,-0.0434537,0.0471016,0.0768531,0.2457382,-0.069650731,0};
const cof1 NextStepCalcML::NP_4YR = {-1.9339513,0,0,-0.1214638,0.2085973,0,0,-0.0912975,-0.2006582,0.2635971,0,0,0.0106184,0,-0.0046685,0,0.2068356,0,-0.0331627,1.0416001,0.0686399,0.0204825,0,0,0,0,-0.100706498,0};
const cof1 NextStepCalcML::NP_5YR = {-0.82529376,0,0,0.20446029,0.15558135,0.29316415,-0.05990661,0,0,0.18421644,0,0,0.00936985,0,-0.00604279,0,0.12728167,0,-0.02622263,0.97548289,0.04938709,0.02496473,0,0,0,0,-0.041231426,0.08324079};
const cof1 NextStepCalcML::NP_6YR = {-2.3394962,0,0,0,0,0,0,0,0,0.1951358,0,0,0.0104845,0,-0.0049763,0,0.1078406,0,-0.0079735,0.9445675,0.0448701,0,-0.0783884,0,0,0,0,0};
const cof1 NextStepCalcML::P_2YR = {-1.8499522,0,0,0,0,-0.0797277,0.1757107,-0.1480977,-0.2486273,0,0,0,0.0052231,-0.0455031,-0.0014086,0,0.0729576,0,0,0,0,0.095253,0.0118671,0.132382,0.2753678,0,0,0};
const cof1 NextStepCalcML::P_3YR = {-0.4821234,0.0542923,0.0753316,-0.075545,0.0751038,0,0,-0.1451634,-0.2357427,0,0,0,0.0059595,-0.0332247,-0.0017416,0,0.0381576,0,-0.0234693,-0.1372527,0.0198888,0.0253058,0.0767628,0.1808482,0.2383561,0,0,0};
const cof1 NextStepCalcML::P_4YR = {0.498649,-0.0715717,0.0820901,-0.1056517,0.0861272,0.0752293,0.1722763,-0.2253557,-0.2253026,-0.0530569,0,0,0.0038043,-0.0189006,-0.0027662,0,0.041263,0,-0.0202586,-0.1609313,-0.0208131,0.0221323,0.0586546,0.0595171,0.1772283,0.2694226,0,0};
const cof1 NextStepCalcML::P_5YR = {-0.1278594,0,0,-0.1400283,0.0744393,-0.0084133,0.1746942,-0.2130477,-0.2203384,-0.0585977,0,0,0.0042806,-0.0245636,-0.0031311,0,0,0,0,-0.0997697,-0.0353774,0.0360544,0.070337,0.1170591,0.1603103,0.2562916,0,0};
const cof1 NextStepCalcML::P_6YR = {0.4121139,0,0,-0.3030958,-0.0544568,0.3044568,0.1149326,-0.2633887,-0.2278137,0.0716749,0,0,0.0072872,-0.0419365,-0.0035865,0,-0.0185513,-0.0340627,-0.0098122,-0.1454319,-0.0176058,0.0284564,0.0811517,0.1066104,0.1721674,0.2057158,0.039929292,0};
const cof1 NextStepCalcML::L2_NP_2YR = {6.658545,-13.442351,-1.048318,0,0,2.08534,1.968335,-1.049229,-12.936849,0,0,0,0,0,-0.021125,0,0,0,-0.0837,0,0,0.111315,0.478956,-0.878497,0.910927,-0.195739,0,0};
const cof1 NextStepCalcML::L2_NP_3YR = {5.116057,0,0,0,0,0,0,-1.533042,-13.345135,1.05824,0,0,0,0.0925,-0.015189,0,0,0,-0.147843,0,0,0,0,0,0,0,0,0.706365};
const cof1 NextStepCalcML::L2_NP_4YR = {-6.352,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1.3638,0,0,0,0,0,0,0,0,-0.926994,0};
const cof1 NextStepCalcML::L2_NP_5YR = {4.19074,0,0,0,0,0,0,0,0,0,0,0,0,0,-0.02187,0,0,0,0,0,0,0,0,0,0,0,0,0};
const cof1 NextStepCalcML::L2_NP_6YR = {-5.4251169,0,0,0.7183449,-8.3668645,-0.4853096,0.9412768,-0.3905894,0.6020459,0,0,0,0,0.1013825,-0.0048778,0,0,0,0.032559,0,0,0,0,0,0,0,0,0};
const cof1 NextStepCalcML::L2_P_2YR = {-4.7897481,0.009245,0.0941644,0.2932948,0.0950775,0,0,-0.1351834,-0.2575806,0.1148992,0,0.0013413,0.0012626,0.1786218,-0.0006721,0,0.3190078,-0.0388228,-0.0141648,0.4951392,0.0853353,0,0.634154,-0.1049389,-0.0460717,0.250455,-0.125216281,0};
const cof1 NextStepCalcML::L2_P_3YR = {-2.1988149,0.1879126,0.0787358,0.2650457,0.0209208,0.1654741,0.1047629,-0.1987875,-0.3421679,0.211166,0,0.001623,0.0038848,0.1293208,-0.0017481,0,0.0990384,0,-0.0459019,0,0.0611128,0,0.631796,-0.1833898,-0.111396,0.0484562,0,0};
const cof1 NextStepCalcML::L2_P_4YR = {-0.93970644,0,0,0.14835902,-0.5182045,0.24809322,0.38082501,-0.23144205,-0.44819965,0.14308801,0,0,0.00361805,0.13270237,-0.00255135,0,0.05534487,0,-0.04183381,0,0.07278163,0,0.52626296,-0.06504335,0.00091251,0.09293795,0,0.17044371};
const cof1 NextStepCalcML::L2_P_5YR = {0.097755,0,0,0.1178489,-0.4370915,0.3400812,0.4733553,-0.1898983,-0.4939432,0,0,0,0.0056986,0.1066853,-0.0040719,0,0,0,-0.0270057,0,0.0667323,0,0.3388999,0,0,0,0,0};
const cof1 NextStepCalcML::L2_P_6YR = {-1.1807332,0,0,0,0,0,0,-0.1613432,-0.4512415,0.1605125,0,0,0.0080813,0.0794115,-0.0050825,0,0,0,-0.0084694,0,0.0323395,-0.1063718,0.4742203,-0.1757752,-0.1747113,-0.0244617,0.103560685,0.1036809};

const cof2 NextStepCalcML::T3_L1_2YR ={{-1.97370866,0.0309822,-0.01314912,0.09619826,0.0294516,-0.06834994,-0.04799434,-0.00107076,0.032151,0.0124329,0,0.00105873,0.0072045,0.03634714,-0.00022704,0,-0.01891725,-0.01360307,0.01980871,0.30621746,0.04247259,0.01540028,0.01933445,0.19229385,0.24704},{-4.70007805,-0.00513798,0.08547307,0.21023535,0.2226271,0.26578599,0.44712898,-0.1042002,-0.05434068,0.17321605,0,0.00179811,0.01277264,0.11742814,0.0034911,0,0.09710399,-0.05800997,-0.00803606,-0.06093015,0.07849016,0.00854437,0.08405062,0.23024083,0.278}};

const cof2 NextStepCalcML::T3_L1_3YR ={{-2.24628027,0.18651333,-0.00064826,0.12350531,-0.00098597,-0.08809829,0.00074279,0.03019239,0.02926174,0.04034151,0,0.00042646,0.00584688,-0.02113864,0.00108575,0,0.01178705,0,-0.00141078,0.29191524,0.0696927,0.01450107,0.04224555,0.2361119,0.27256345,0.2},{-2.92400995,0.15949967,0.13690028,0.19272046,0.22587977,0.11224787,0.31489499,-0.11361942,-0.13701544,0.10737203,0,0.00175578,0.01192657,0.07749744,0.00334029,0,0.02637691,0,-0.02126841,-0.08266837,0.06835375,0.02852549,0.05320527,0.13926648,0.17134048,0.}};

const cof2 NextStepCalcML::T3_L1_4YR ={{-1.35538899,0.15837516,0.06976719,0.07747766,0.00548618,-0.14846107,0.03061997,0.01814204,-0.00926915,0.03304472,0,0.00081365,0.00462786,-0.05664811,0.00056466,0,0.00165806,0.02923689,-0.00457954,0.23683151,0.06805258,0.0186617,0.04458035,0.16541501,0.214},{-1.61767906,0.04918923,0.16416973,0.13852085,0.25125907,0.1595554,0.28266337,-0.07268358,-0.15150663,0.06957195,0,0.00046141,0.01051511,0.02197376,0.00244055,0,-0.03033882,0.0389673,-0.01600517,-0.07524225,0.04384514,0.02696814,0.06149074,0.11681356,0.179}};

const cof2 NextStepCalcML::T3_L1_5YR ={{-1.2578,0.17005,0.023887,-0.016235,-0.027602,-0.0025204,0.058137,-0.022274,0.0084615,0.016107,0,0.0010643,0.0033006,-0.078601,0.00066448,0,-0.013755,0.032501,-0.0033579,0.26245,0.071126,0.03007,0.049993,0.18919,0.18662,0.23066,-0.026044,0},{-1.5316,0.1095,0.14572,-0.00136,0.15681,0.1866,0.2352,-0.10349,-0.078855,0.041711,0,0.00002647,0.0096794,-0.020516,0.0021518,0,-0.03561,0.033012,-0.0096738,-0.036875,0.051444,0.031026,0.081082,0.16809,0.2067,0.23565,-0.03715,0}};

const cof2 NextStepCalcML::T3_L1_6YR ={{-1.28133695,0.03210039,0.07560059,-0.00943867,-0.10556622,-0.02253618,0.0131767,0.01023021,0.06162295,0.04889453,0,0.00147113,0.00456502,-0.09134564,0.00040378,0,0.00740421,0.0300655,0,0.18869795,0.05193762,0.01927282,0.07426945,0.2088463,0.21339085,0.235},{-2.13484654,0.09291646,0.17096943,-0.08355523,-0.04089341,0.17393013,0.23129862,-0.06396394,-0.0121268,0.07468465,0,0.00040269,0.0109111,-0.01058382,0.00178443,0,-0.02358329,0.03103758,0,0.07537732,0.03993186,0.0223887,0.11895725,0.16460278,0.22237985,0.2}};

const cof2 NextStepCalcML::T3_L2_2YR ={{-2.72394325,-0.05413737,0.05179003,0.12371628,0.14626765,-0.30710715,-0.26790247,-0.02444763,-0.07958826,-0.07148898,0,0,0.00111078,0.11275099,0.00040669,0,0,-0.01734902,0.02751003,0.32488341,0.0458847,0.06051092,0.23814955,0.12165787,0.17260412,0.2703147},{-3.51958287,0.09031741,0.09609706,0.02204354,-0.0078447,0.21214685,0.35615051,-0.09877333,-0.03129044,0.15156969,0,0,-0.00019602,0.26335651,0.00477547,0,0,-0.02384328,-0.00844674,-0.34966163,0.04877247,0.07302757,0.3999382,0.13823714,0.22281586,0.37827781}};

const cof2 NextStepCalcML::T3_L2_3YR ={{-2.9323,0.011963,0.055108,0.1113,0.27083,-0.098658,-0.017728,0.056594,0.044723,0,0,-0.00000309,0.0017573,0.03578,0.00095175,0,0.035193,-0.022418,0.0062521,0.29925,0.07168,0.014983,0.62507,0.15465,0.24345,0.27371,0.040794,0},{-1.8821,0.080897,0.11568,-0.0091205,-0.17389,0.2622,0.38704,-0.17206,-0.14402,0,0,-0.00046535,0.00066634,0.24167,0.0046329,0,-0.049523,0.005017,-0.020302,-0.52385,0.038184,0.034151,0.68898,-0.08247,-0.018288,0.20653,0.067776,0}};

const cof2 NextStepCalcML::T3_L2_4YR ={{-2.35639619,0.06257697,0.07027553,0.13901483,0.02035245,0.06935084,-0.03094124,-0.00469197,-0.0154552,-0.0268427,0,0.00204711,0.00764987,0.00093374,0,0.01913008,-0.03649615,-0.00326225,0.33981003,0.05866196,0.03846372,0.53565427,0.12920442,0.18951685,0.20},{-1.51785547,0.11580751,0.18937579,0.02087732,-0.20348782,0.39288276,0.44315532,-0.16442387,-0.06852989,0.08720869,0,0.00187995,0.14292219,0.00382678,0,-0.04210813,0.02333178,-0.01997374,-0.3962624,0.05891037,0.03209856,0.5791088,0.06774621,0.17669875,0.20}};

const cof2 NextStepCalcML::T3_L2_5YR ={{-3.09753988,0.21590227,0.10029675,0.17292055,-0.12877683,-0.08312604,-0.15996703,0.02746587,0.09512565,0,0,0.00061676,0.00086209,0.00196235,0.00174121,0,0.01644906,0,-0.00124202,0.38587126,0.06375659,0.04425548,0.50366884,0.1404239,0.15401203,0.18889839,0},{-2.4789291,0.2649864,0.22639655,-0.03552139,-0.2617902,0.38448894,0.41548779,-0.02439189,-0.07461824,0,0,-0.00018011,0.00178486,0.11741379,0.00373133,0,-0.03458607,0,-0.01047037,-0.25878161,0.07373687,0.02199879,0.60073242,0.14971937,0.22557838,0.24083183}};

const cof4 NextStepCalcML::T6_L1_2YR ={{-0.1091802,0.0511638,0.0079391,-0.4093939,-0.2471746,-0.2168105,-0.6334761,0.1521167,0.1760056,-0.1770012,0,0.0038412,-0.0081812,-0.0840511,-0.0053095,0,-0.0063504,0.025745,0.0766483,0.7214966,-0.0439692,-0.0302713,0.0183731,-0.2451048,-0.3457596,-0.24682},{-1.632806,-0.0058229,0.0291077,-0.4278761,-0.347374,-0.370347,-0.6997026,0.1929407,0.2294604,-0.2292014,0,0.0049244,-0.0011965,-0.0642486,-0.0043435,0,0.001081,0.0484864,0.0934249,0.7979785,0.006783,-0.0282565,0.0249737,-0.0980537,-0.1628297,-0.0628208,0.},{-3.1122827,-0.0225972,0.0929378,-0.2269837,-0.1307988,0.1997291,-0.3960018,0.1701963,0.134235,-0.1170775,0,0.0070271,0.0030427,-0.0052065,-0.0015419,0,0.1683307,-0.0357444,0.0453096,0.2863358,0.0816404,-0.0428619,0.0967985,-0.2008221,-0.1799022,0.019761,0},{0.9836401,-0.1917088,0.0736144,-0.5436596,-0.3471373,-0.0933064,-0.5574549,0.2383815,0.1141187,-0.2853573,0,0.0037565,-0.0129981,-0.0421778,-0.0048571,0,-0.0111309,0.0418516,0.0480061,0.3610279,0.0499845,-0.0239348,-0.0352339,-0.3457452,-0.4193831,-0.3958174,0.045083667,-0.9779487}};

const cof4 NextStepCalcML::T6_L1_3YR ={{0.76041277,0.2860917,0.02865822,-0.5145254,-0.30821317,-0.28222853,-0.49191168,0.14871437,0.04609055,-0.11719102,0,0.00223821,-0.00958977,-0.15548553,-0.00439024,0,-0.00066253,-0.0514012,0.02430503,0.79453424,0.02182592,-0.03045552,-0.00856691,0.02304012,-0.02296399,-0.01413833,0.041586673,-1.0067882},{-1.94697021,0.06118814,-0.0981816,-0.39272583,-0.38678837,-0.43936582,-0.67807129,0.20873919,0.15484239,-0.15021224,0,0.00291879,-0.00389396,-0.11564982,-0.00240303,0,0.02728422,-0.02507733,0.04138794,0.81045345,0.08889536,-0.01957278,0.01678262,0.1360009},{-0.46794216,0.15287987,0.03139384,-0.24687972,-0.20364703,-0.09477596,-0.50863882,0.03753492,-0.05104052,-0.05870978,0,0.00512057,0.00091346,-0.029899,-0.00232592,0,0.05373774,-0.05865643,0.01527724,0.33291449,0.08596629,-0.0146206,0.03781845,-0.02635202,},{1.17943246,0.02712315,-0.07978226,-0.30242669,-0.28357412,-0.47498901,-0.78123786,0.08513545,0.05880518,-0.25367626,0,0.00152878,-0.00964679,0.01271394,-0.00471748,0,-0.01415336,-0.00945937,0.02521701,0.36876898,0.04127493,-0.02213261,-0.03181176,-0.31438815,-0.45401676,-0.26622649,0.070844219,-0.37857136}};

const cof4 NextStepCalcML::T6_L1_4YR ={{-0.3089952,0.0431827,-0.0410233,-0.0934966,-0.3526732,-0.3614341,-0.4711483,0.1905367,0.0651411,-0.0672328,0,0.0019129,-0.0078589,-0.1741648,-0.0037699,0,0.0674074,-0.0708374,0.0175942,0.6639257,0.0277429,-0.0356864,-0.03123,-0.0034192,0.0010623,0.0989529},{-1.1924403,0.1068986,-0.1033326,-0.1125831,-0.275563,-0.5572509,-0.5686727,0.1882535,0.2104267,-0.0250492,0,0.002379,-0.002679,-0.172084,-0.0026841,0,0.0787772,-0.031012,0.0162697,0.6759568,0.0929372,-0.0105471,0.0254556,0.1531716,0.1284371,0.1884835,0.02},{0.767362,0.1701958,0.0402122,-0.0785825,-0.1560432,-0.3067649,-0.5655822,0.0845143,0.0153568,-0.0074028,0,0.0015796,0.0025062,-0.1220708,-0.002668,0,0.0477193,-0.0360837,0.0076133,0.2753154,0.0628503,-0.0053139,0.0367064,0.0951147,0.141563,0.2536242,-0.000539138,-0.5750581},{0.533364,-0.0742782,-0.1059838,-0.2291148,-0.196016,-0.4761156,-0.7556298,0.1255989,0.1524163,-0.1111333,0,0.0020066,-0.0052886,-0.0334784,-0.0042441,0,0.0536063,-0.0731965,0.0179228,0.3125878,0.0088129,-0.0286614,-0.0233844,-0.1748895,-0.280159,-0.162533,0.070809329,-0.5784791}};

const cof4 NextStepCalcML::T6_L1_5YR ={{-0.17406734,-0.00390056,-0.17250567,-0.07118285,-0.21810672,-0.60167257,-0.62737423,0,0,0,0,0.00283874,-0.00682244,-0.15611803,-0.0035155,0,0.088769,-0.04420912,0.01460205,0.67577921,0.05017856,-0.00055071,-0.02169794,0.06436983,0.00509338,0.01404524,-0.0},{0.05897918,0.09211966,-0.19589785,-0.01360667,-0.26329771,-0.64618781,-0.73793286,0,0,0,0,0.00315757,-0.00492617,-0.1571402,-0.00296771,0,0.06973758,-0.0117432,0.01108473,0.65324903,0.08951352,0.01653665,0.01521214,0.15280309,0.13452139,0.11059222,-0.039963154,-0.66240072},{0.86216212,0.09284544,-0.09244526,-0.02974313,-0.11962357,-0.53538319,-0.63419523,0,0,0,0,0.00087653,0.00190479,-0.15990941,-0.00250685,0,0.04515174,-0.03872107,0.00716044,0.22072689,0.07024617,0.00859105,0.03915978,0.16815104,0.19470741,0.18420701,-0.009798284,-0.32922621},{1.5603262,-0.20044467,-0.23371264,0.0308143,-0.16844819,-0.90138686,-0.78617769,0,0,0,0,-0.00060899,-0.00764229,-0.14805778,-0.00387372,0,0.07655526,-0.06052392,0.00520635,0.2952824,0.0179254,-0.01532249,-0.02931576,-0.0128988,-0.11064341,-0.11685425,0.029015544,-0.03283463}};

const cof4 NextStepCalcML::T6_L1_6YR ={{1.8104985,-0.09438679,-0.1045711,-0.04945472,-0.10558177,-0.06032375,-0.53695869,0,0,-0.03403044,0,0.00044801,-0.00712466,-0.17659375,-0.00375347,0,0.04472186,-0.0555961,0.00332862,0.30952039,0.01711845,0,-0.04898925,0.19185621,0.10982234,-0.02454042,-0.022975146,-0.05685671},{2.20209217,0.08941329,-0.14429779,-0.30598745,-0.19810559,-0.35160498,-0.70882115,0,0,0.01190708,0,-0.00129078,-0.00173238,-0.17005195,-0.00385064,0,0.07909657,-0.05233204,0.00619533,0.33034565,0.05970862,0,-0.00427125,0.25745013,0.10684713,0.01394962,-0.06001294,0.280711},{1.91493911,-0.05936927,-0.06634703,-0.15825636,-0.1095742,-0.34790295,-0.50525954,0,0,0.02275682,0,-0.0024183,0.0046072,-0.12391417,-0.00265184,0,0.04520187,-0.05786319,0.0027583,0.12162969,0.05246805,0,0.03455538,0.22454365,0.19103458,0.03933054,-0.024487283,0.41276501},{2.26915159,-0.04885707,-0.14609344,-0.16275631,-0.05841989,-0.58146056,-0.63907563,0,0,-0.08462738,0,-0.00192786,-0.00754076,-0.01617506,-0.00304596,0,0.02891302,-0.07316525,0.00317361,0.11918283,-0.00277182,0,-0.04514614,-0.05125042,-0.16984102,-0.37955282,0.012844377,0.27665708}};

const cof4 NextStepCalcML::T6_L2_2YR ={{1.01829771,0.22699434,0.00852094,-0.25653689,0.0962717,-0.04384146,-1.03502937,-0.2249429,-0.02330413,0.06637416,0,0.00377961,-0.003027,-0.03655161,-0.00499726,0,0.08605611,-0.06941777,0.06900275,0.60972417,0.08952825,0,-0.85266981,0.2399864,-0.32018815,0.04251326,-0.005201695,-1.07300089},{-0.30278996,0.22315278,0.08102556,-0.3352642,0.1168526,0.00956887,-1.03119324,-0.12352825,0.16450296,-0.08937128,0,0.00418764,-0.0025743,0.04598208,-0.00421718,0,0.14439804,-0.10197316,0.07982313,0.65712753,0.13606126,0,-0.71058512,0.31247197,-0.25684096,},{0.70042848,0.19028243,0.08605964,-0.33419661,0.02898662,0.5119182,-0.27378267,-0.147243,0.10174145,0.14772427,0,0.00456316,-0.0034493,0.17221515,0.00064241,0,0.09223917,-0.07867615,0.00306251,-0.08949381,0.14241276,0,-0.43019474,0.35650465,-0.11331687,0.28998159,0.054243494,-1.1260617},{3.52908013,0.058518,-0.04382499,-0.40913855,-0.42230259,0.17729153,-0.67512804,-0.08939928,0.22518001,-0.0137035,0,0.00313555,-0.00355952,-0.04552821,-0.004798,0,0.11232769,-0.03300136,0.02782912,0.25044278,0.098982,0,-1.31704663,0.19166219,-0.40761887,-0.1269741,-0.099476792,-0.92734797}};

const cof4 NextStepCalcML::T6_L2_3YR ={{-0.09800521,0,0,-0.09846289,-0.7735493,-0.13621372,-0.7449096,-0.20140545,0.2451926,0.00187222,0,0.00223798,-0.00245825,-0.13293926,-0.00305664,0,0.10238061,-0.05590066,0.01710702,0.73926338,0.13930185,0,-0.82473685,-0.11220658,-0.16213082,0.12014106,0.02},{-1.98376061,0,0,-0.19983182,-0.56641013,-0.29573962,-0.85495687,-0.21600069,0.20868709,-0.07582606,0,0.00320681,-0.00323056,-0.10934899,-0.00167832,0,0.1558991,-0.13824372,0.02752492,0.78968492,0.21009877,0,-0.28686381,-0.03750434,-0.08227402,0.16161919,0},{1.07500534,0,0,-0.21352369,-0.16528919,0.19296278,-0.15457895,-0.43858712,0.1221828,0.04984428,0,0.00291533,-0.00325637,0.0777436,0.00133916,0,0.01879161,-0.1152655,-0.00951119,-0.20006105,0.15529543,0,-0.09783486,-0.2569935,-0.28791899,0.15205688,0.157454936,-1.04462487},{-0.68555116,0,0,-0.25851405,-0.53701013,-0.09482204,-0.7306532,-0.24674338,0.33763694,-0.11312928,0,0.00347652,-0.00393085,-0.14074568,-0.00169112,0,0.08281639,-0.10619559,0.01990639,0.38150931,0.15241234,0,-0.9134918,-0.22330653,-0.32656796,-0.07958531,0}};

const cof4 NextStepCalcML::T6_L2_4YR ={{1.47236485,0,0,0.24397771,-0.56337766,0.21322744,-0.77848572,-0.28112011,-0.26095207,-0.07766453,0,0,-0.00394733,-0.0690936,-0.00281325,0,0.03416752,-0.03690184,0,0.86987259,0.0634274,0.01999687,-0.45802089,-0.03678326,-0.08318253,0.07940892,0.059013739,-0.04098778},{-0.11778724,0,0,0.23213957,-0.45123939,0.07370897,-0.73612722,-0.28755105,-0.0948923,-0.13697381,0,0,-0.00389887,-0.06699847,-0.00154576,0,0.06972172,-0.10334455,0,0.89605623,0.12700995,0.01734511,-0.00529846,0.10972805,-0.01665539,0.2637685,0.137784355,-0.05659},{1.90701885,0,0,0.09242361,-0.60446786,0.50531326,0.00579599,-0.52005699,-0.25605276,-0.04002367,0,0,-0.00283325,0.08387065,0.00124008,0,-0.04215977,-0.01810268,0,-0.02115971,0.09734318,0.02458714,0.03325675,-0.00927108,0.0284715,0.27248654,0.106936457,-0.20579893},{1.86807345,0,0,0.02218856,-0.9833941,0.09756364,-0.49140736,-0.39793201,-0.02721366,-0.20244554,0,0,-0.00613073,-0.01257973,-0.00184337,0,-0.01623289,-0.04886555,0,0.43713324,0.0793457,0.06711612,-0.88545824,-0.11666859,-0.19429861,-0.04916584,0.136611837,-0.07631172}};

const cof4 NextStepCalcML::T6_L2_5YR ={{0.79765181,0.16721128,0.08341079,0.03362471,-0.79688773,-0.36205448,-1.15685143,-0.32752287,0.31608715,-0.10959987,0,0.0030658,-0.00757361,-0.15345746,-0.00146344,0,0.07777694,0,0.0041706,0.65712714,0.06023363,0,-0.54906829,0,0,0,0,-0.49029094},{-0.69705882,0.09360382,0.15165943,0.03230242,-0.83105097,-0.7155304,-1.10749518,-0.29910329,0.45878736,-0.13429089,0,0.00292144,-0.00797656,-0.12915112,0.00058602,0,0.12055231,0,0.00252337,0.76719024,0.10901974,0,0.0814867,0,0,0,0,-0.49600877},{2.71252158,0.00619885,0.25243528,-0.11417346,-0.69459172,-0.18213565,-0.35069243,-0.39023587,0.24829599,-0.08561654,0,0.00294024,-0.00688506,-0.0332956,0.00132509,0,0.02848124,0,-0.01247821,-0.09816201,0.11306791,0,-0.08254279,0,0,0,0,-0.56788675},{2.07410871,0.01198498,0.07845281,-0.26716775,-1.13004531,-0.62682939,-1.03858251,-0.30545076,0.34907625,-0.24704415,0,0.00316755,-0.01094498,-0.15249875,-0.00077445,0,0.05159836,0,-0.00093061,0.2791881,0.06100516,0,-0.64653506,0,0,0,0,-0.60730682}};

const cof4 NextStepCalcML::T9_L1_2YR ={{-14.069,-0.11402,-0.11991,-0.41142,-0.45844,-0.20447,-0.63832,0.085412,-0.0029483,0.14249,0,0.0047048,-0.010677,0.0485,0.0073128,0,0.62141,-0.088075,0.095658,0.52327,0.01545,-0.12099,0.15034,0.32009,0.3088,0.15305,0.0766,-2.7997},{3.617,-0.53214,-0.21887,-0.43515,-0.20983,-0.7052,-0.76013,-0.036554,-0.040961,-0.28988,0,-0.0015592,-0.009785,-0.10059,-0.0042501,0,-0.26288,0.10894,0.0099254,0.061972,-0.051073,0.0012799,-0.11179,0.040345,-0.067437,-0.095978,0.069478,0.14144},{-1.1606,0.11629,0.020673,-0.3198,-0.17535,0.11891,-0.3822,0.077315,0.046659,-0.097055,0,0.0022242,0.00055827,-0.07404,-0.00074897,0,0.086283,0.010873,0.054242,0.34191,0.11181,-0.029741,0.058805,0.020027,-0.015538,-0.1122,0.059471,-1.497},{0.48039,0.055768,0.070292,-0.4865,-0.23289,-0.48178,-0.64346,0.14858,0.26569,-0.4193,0,0.00072387,-0.016318,0.24912,-0.0037894,0,-0.17456,-0.01558,0.059186,0.14768,0.13558,0.0079307,-0.14005,-0.21743,-0.26833,-0.19918,0.21461,-0.51766}};

const cof4 NextStepCalcML::T9_L1_3YR ={{-7.5213,0,0,-0.26656,-0.46383,0.32239,-0.0097152,-0.079819,0.1536,0.16589,0,0.0018082,-0.011561,0.10742,0.0035878,0,0.46193,-0.072712,0.0044736,0.44394,0.091175,-0.076319,0,0.12178,0.11779,0.18539,-0.0098762,-2.139},{3.7238,0,0,-0.53995,-0.40043,-0.81255,-0.55893,0.069254,0.42241,-0.30659,0,-0.00095046,-0.0095633,-0.075649,-0.0059694,0,-0.09207,0.0081556,0.0085944,-0.14395,0.012466,-0.035338,0,-0.074018,-0.1902,-0.27894,0.10344,-0.51593},{1.0089,0,0,-0.32442,-0.22702,-0.25614,-0.38142,0.15318,0.10945,-0.060537,0,-0.00006489,0.0012173,-0.10433,-0.0016945,0,0.021326,0.039672,0.016843,0.25712,0.14276,-0.0065028,0,0.11384,0.16578,0.075144,0.016308,-0.77215},{1.4556,0,0,-0.11173,-0.28699,-0.74189,-0.71241,0.099348,0.086728,-0.2218,0,-0.0024585,-0.0099513,0.15788,-0.0047978,0,-0.12633,-0.00050182,0.01854,0.077003,0.10071,-0.01275,0,-0.2188,-0.35517,-0.24155,0.21019,0.55927}};

const cof4 NextStepCalcML::T9_L1_4YR ={{-6.78458928,0,0,0.20290022,-0.34752289,-0.23143067,-0.04482949,-0.06947342,-0.24819061,-0.02857468,0,0.001225,-0.00127566,0.02156578,0.00391601,0,0.31170493,0,0,0.14854118,0.06317553,-0.07227693,-0.04157689,0.20454125,0.09086179,0.19409245,-0.001172236,-1},{3.10787419,0,0,-0.22358465,-0.1220427,-0.64231434,-0.6821795,-0.02990653,-0.1472589,-0.2741857,0,0.0023764,-0.00916386,0.05203654,-0.00581312,0,-0.02392192,0,0,-0.31864136,-0.0201714,-0.06007294,-0.00695511,0.00244706,-0.07326439,-0.30221466,0.048637413,-0.49388619},{0.79465994,0,0,-0.1442631,-0.1618228,-0.36201792,-0.47051419,0.12684953,0.04812181,-0.04886183,0,0.00210849,0.00139063,-0.05774205,-0.00114992,0,0.03551967,0,0,0.16053681,0.09813701,-0.01680239,0.0224829,0.08811991,0.02504721,0.00747437,0.043169081,-0.68648778},{0.89683653,0,0,0.1968517,-0.04204527,-0.88085964,-0.76156493,0.15350616,0.20015686,-0.07354837,0,-0.00078177,-0.00384941,0.09193424,-0.00285819,0,-0.09828077,0,0,-0.07872568,0.03390695,-0.02253659,-0.02928781,-0.0118531,-0.22806274,-0.34721164,0.162146504,0.41512397}};

const cof4 NextStepCalcML::T9_L1_5YR ={{-7.2763886,-0.1668345,-0.1788236,0.1030386,-0.1881032,0.0378252,0.0457438,-0.0651415,-0.0159745,0,0,0,0.0055289,0.079062,0.0043354,0,0.3820022,0,0,0.1092501,0.0219153,-0.0764747,-0.0366787,0.2030407,-0.2016817,0.0935674,-0.048378923,-1.2259362},{4.0269866,-0.0566961,-0.0676356,-0.1548541,-0.3518684,-1.096398,-0.3168683,0.0517715,-0.0632403,0,0,0,-0.010267,0.1226564,-0.0059402,0,0.0168465,0,0,-0.3670457,-0.0632858,-0.0302826,-0.0430258,-0.0844782,-0.2534808,-0.1736651,0.019844554,0.0303117},{2.2641541,-0.077886,0.0231656,-0.0824648,-0.1357337,-0.436665,-0.420055,0.0053391,-0.0108906,0,0,0,0.0017787,-0.0220602,-0.0018698,0,0.0477729,0,0,0.1102795,0.0549656,-0.01409,0.0344375,0.098878,-0.0738481,-0.0486276,-0.003905843,-0.0887083},{0.6180669,-0.1930782,-0.147238,-0.0402042,-0.2534738,-0.4304605,-0.6876044,0.0264889,0.179531,0,0,0,-0.0035679,0.1721766,-0.0021926,0,-0.0812447,0,0,0.0085921,0.0065303,-0.021422,0.0054349,-0.0911239,-0.2804522,-0.5158568,0.170485031,0.0098955}};

const cof4 NextStepCalcML::T9_L1_6YR ={{-7.35180914,0.1142195,0.03388219,0.81759557,-0.07465433,0.62877829,0.10694119,0.08746284,0.07971469,-0.24985303,0,-0.00137458,0.00993919,-0.14303426,0.00284019,0,0.35866684,-0.14089576,0,-0.2003187,0.07479021,-0.08630303,-0.14583918,0.08537965,-0.22295282},{1.31768518,0.08935613,0.075146,0.02898942,-0.02619281,-1.56496492,-0.75825865,0.16960303,0.18317596,0.05115637,0,-0.00723858,-0.00844279,0.01987538,-0.0011965,0,0.03643319,0.06749505,0,-0.05756894,-0.01518771,-0.01860551,-0.14736436,0.04792891,-0.33990273,-0.42976919,-0.026235897,1.31248253},{1.65288191,0.25397335,0.05820572,0.01178006,0.01594967,-0.38897521,-0.43762176,0.10134287,0.00944466,-0.0590523,0,-0.00256952,0.00112425,-0.08487806,-0.00036433,0,0.05072033,-0.00140519,0,0.10255099,0.07005436,0.00480734,0.02810287,0.15707065,0.0111438,0.00610564,-0.027230154,0.45288453},{1.64600005,-0.10258243,-0.08142391,-0.50372619,-0.2780678,-0.51887139,-0.88511477,-0.0017483,0.11364667,0.02104341,0,-0.00451007,-0.00074787,0.13499165,-0.00205854,0,-0.10927325,-0.01151145,0,-0.02987867,-0.00069454,0.01801039,-0.02282166,0.04204481,-0.30628963,-0.32880293,0.14170723,0.80086641}};

const cof4 NextStepCalcML::T9_L2_2YR ={{-5.32258985,-0.39738117,0.0712977,-0.39227242,1.66681583,0.65632477,0.06201249,0.09030675,0.29417686,0.15126019,0,0.00096809,-0.00495456,0.03074421,0.00421131,0,0.21760086,-0.0884625,0.07592393,0.27783008,0.10786621,0,-0.44345677,-0.21708287,0.40586339,0.},{4.76232138,0.00274055,-0.18761155,-0.38953255,0.40666958,0.48490481,-0.5232722,-0.33305441,-0.11760136,-0.36372457,0,-0.00178333,-0.00484644,-0.16667937,-0.00671348,0,0.05043196,-0.09094113,0.03288865,0.04991657,0.03348349,0,-0.73212404,-0.05406849,0.20851748,0.09040674,-0.046432753,-0.49642345},{0.42025049,-0.07229948,-0.09800057,-0.47553918,0.13641736,0.88670778,-0.12422911,-0.09870272,-0.04067482,-0.11681457,0,0.00199645,-0.00524537,0.0203838,0.00118101,0,0.02012164,-0.10159192,0.03092815,0.11737901,0.13329119,0,-0.29190423,-0.11685855,0.28265873,0.33905337,0.141128183,-0.93372581},{1.25750678,-0.36088434,-0.08838539,-0.54185726,0.1361162,0.03176167,-0.77891217,-0.02728104,0.48065704,-0.81150333,0,-0.00324559,-0.02194914,-0.13820848,0.00497812,0,0.06857,-0.00043123,0.01991172,-0.65154293,0.08008015,0,-1.31835518,0.98865071,0.31969137,0.06184637,-0.105433091,-0.18688387}};

const cof4 NextStepCalcML::T9_L2_3YR ={{-2.3970171,-0.18689364,0.14386238,-0.02900319,1.923518,0.07763043,0.13569719,-0.05265331,0.08607723,0.17063364,0,-0.00182633,-0.0021784,0.04451836,0.00214681,0,0.17190887,-0.03537113,0.02587257,0.07875748,0.18588156,-0.06523414,0.06274295,-0.20145053,-0.0},{1.82905127,0.09541474,-0.04978484,0.22140153,0.42345393,-0.34322144,-1.02911387,0.02593958,0.01947291,-0.26587777,0,-0.00517067,-0.00174076,-0.15097597,-0.00478161,0,-0.02129432,-0.02382414,0.01289366,0.12382273,0.08448703,-0.09336365,-0.89431394,-0.00669271,-0.0223729,-0.1496398,0.148122226,0.36223814},{1.09994843,0.01114459,0.01735227,-0.12961322,0.34230158,-0.06879964,-0.1628653,-0.22757814,-0.04798098,-0.08617573,0,-0.00137876,-0.00469859,0.02370831,0.00012043,0,0.05157516,-0.08884526,0.01638044,0.08958488,0.20058328,-0.06881292,0.16977383,-0.09441875,0.01775475,0.10640622,0.143550315,-0.30703677},{0.94198252,-0.37838912,-0.0421024,-0.54046893,0.51590838,-0.90087952,-1.26497399,-0.09788277,0.58536669,-0.72751293,0,-0.00335876,-0.01301425,-0.14795883,0.00445056,0,0.14383073,0.04186955,-0.04990366,-0.51086556,0.16620961,-0.0534062,-0.7329078,0.86725846,-0.01264278,-0.04244371,-0.071002739,-0.3218304}};

const cof4 NextStepCalcML::T9_L2_4YR ={{-2.25477881,0.00857163,0.22856798,0.36417359,1.95473963,0.51222153,0.31775742,-0.04545957,0.09185413,0.29093757,0,0.00048263,-0.00015193,-0.00997487,0.00401181,0,0.00429493,0.01334825,0.01731113,-0.00709496,0.08759019,0.00220022,-0.15211101,-0.1236108,0.0},{0.35066432,-0.51315793,-0.09359729,0.18762245,0.9338318,0.06934777,-0.77959871,-0.03802056,-0.40316129,-0.08249109,0,-0.00113603,-0.00159359,-0.13987385,-0.00406967,0,0.02745392,-0.04510817,0.04205701,-0.11437993,-0.03170138,-0.08095437,-0.08965089,0.03641296,0.0430044,0.21877609,0.096455055,0.13460274},{-0.54878831,0.0232085,0.04844382,0.21453524,0.92737297,0.35794793,-0.25992035,-0.26109406,0.05610851,-0.05371549,0,0.00273746,-0.00312762,-0.01220575,0.00278871,0,0.01400819,0.01006518,0.02493369,0.07460773,0.0820555,0.03035383,-0.1122012,0.06072094,0.110},{-0.34220917,-0.16699823,-0.05384071,-0.1528399,-0.06132393,-0.30018249,-0.62969651,-0.20129443,0.48603867,-0.7403503,0,0.00396607,-0.01075795,-0.090196,0.0040813,0,0.06441895,0.12256474,0.01312877,-0.34100769,-0.02265509,0.03559542,-0.45443282,0.76993635,}};

const cof4 NextStepCalcML::T9_L2_5YR ={{-0.22074027,0.14767107,0.29959222,0.06103131,0.71676028,0.33066502,0.11077934,0.02082162,0.10088104,0.06004668,0,0.00154545,0.00012363,0,0.00297566,0,0,0,-0.01626239,-0.17172941,0.03798268,-0.01574493,-0.0399481,0.20485514,0.17728145,0.26403207,0.02312791},{1.30498346,0.08643962,-0.02492181,-0.03310966,0.1281747,-0.46786065,-1.1296786,-0.15173294,0.50970921,-0.2734062,0,-0.00000807,-0.00323629,0,-0.00134303,0,0,0,0.00444756,-0.07227482,-0.02178393,0.00134488,-0.67466461,-0.14130586,-0.13943388,-0.21434215,0.029147448,-0.07856862},{0.90801083,0.26734846,0.14923032,-0.08500067,-0.0344862,-0.04915239,-0.58697665,-0.27513285,0.24303829,-0.18925019,0,0.0026365,-0.00419129,0,0.00377328,0,0,0,-0.01078519,0.06053272,0.05025584,0.07335729,-0.21531978,0.25950518,0.17165373,0.10221151,0.076126237,-0.52966069},{0.0629675,-0.19520989,0.07104021,-0.36283167,0.40972719,-0.78996391,-1.41343587,-0.24441804,0.56409939,-0.76698728,0,0.00282998,-0.01021394,0,0.00549129,0,0,0,-0.01586429,-0.28695538,-0.13891662,0.0636809,-0.32378777,1.08277182,0.08261921,0.01864829,0.064440864,-0.65274077}};

const cof4 NextStepCalcML::TF_L1_2YR ={{-1.2347153,-0.4886632,-0.2112069,-0.032897,-0.2973869,0.5195481,-0.2802177,0.1705831,0.076644,0.0772059,0,0,-0.0199692,-0.4385917,0.0012898,0,0.0275155,-0.0513687,-0.0089641,-0.092827,0.0265632,0.0035116,-0.0357624,-0.0140374,-0.2126462,-0.3365744,5.14641},{4.043947,0.0994703,-0.1219775,-0.4209082,-0.2692611,-0.3059175,-0.3995417,0.127448,0.2229159,-0.1442492,0,0,-0.0084486,-0.1372069,-0.003767,0,-0.2494553,0.197758,-0.0042122,-0.2135965,0.0667818,0.0025246,0.0186723,-0.1891157,-0.1283971,-0.118011,13.3016971,-0.6166215},{10.182353,-0.0542448,-0.1423959,-0.4476883,-0.394457,0.041732,-0.567702,0.3188436,0.3384691,-0.2183486,0,0,-0.0283891,-0.295648,-0.0047925,0,-0.3810195,0.2653039,-0.0786463,-0.7789969,0.1089601,0.0313986,-0.1248079,-0.1208854,-0.0401323,-0.2704712,3.4302484,-0.3607475},{6.0575119,0.0955775,-0.0746201,-0.1844826,-0.2416827,-0.0499161,-0.2023727,0.1235374,0.125065,-0.061445,0,0,-0.0060397,-0.0189663,-0.0024526,0,-0.0924527,0.1178498,-0.0133908,-0.2534481,0.0659509,-0.0036675,-0.0002085,-0.0740858,-0.0335798,-0.0194058,2.5483537,-0.4801846}};

const cof4 NextStepCalcML::TF_L1_3YR ={{-5.4294617,-0.3498639,-0.0154168,0.2539888,0.0749145,0.4470848,-0.3689211,0.2721465,0.2002537,0,0,0,-0.0083785,-0.2711192,0.0018156,0,0.0828221,-0.1076238,0.0136604,-0.0744891,0.121472,-0.0301401,0.0682482,0.1366591,0.2269916,0.0315305,14.198566,0},{0.5771558,-0.1718241,-0.0566205,-0.2412181,-0.2182657,-0.4559103,-0.5524263,0.0581843,0.0492922,0,0,0,-0.0041064,-0.0666613,-0.0032484,0,-0.1185003,0.1655708,0.0199426,-0.1409855,0.1274745,-0.0033473,0.0351902,0.2046417,0.1462047,0.0639102,11.6308027,0},{4.7359694,-0.4643755,-0.1221249,-0.0930102,-0.3038781,-0.6038369,-0.6456513,0.2448959,0.1594272,0,0,0,-0.0183073,-0.2959314,-0.0052749,0,-0.2018888,0.1786559,0.010568,-0.6289102,0.0653002,-0.0019522,0.0607472,0.0233484,0.2442527,0.1243529,12.3964723,0},{3.8301885,-0.0509609,-0.0064038,-0.1716805,-0.174138,-0.0527747,-0.2762548,0.1767763,0.096403,0,0,0,-0.0043589,-0.0158202,-0.0023265,0,-0.063667,0.076805,0.0045617,-0.0877165,0.0947973,-0.0124038,0.0530877,0.0524648,-0.0195394,-0.0022481,6.9243668,0}};

const cof4 NextStepCalcML::TF_L1_4YR ={{-7.18400799,-0.69303205,0.04062181,0.03109983,-0.14278242,0.15077427,-0.25910594,0.09510971,0.0839375,0,0,-0.00109551,0.00158253,-0.0619713,0.0022121,0,0.17099217,-0.15659988,0.04267624,-0.0599738,0.06727321,-0.03336338,0.10473481,0,0,0,11.62556848,0},{0.25594067,-0.13423534,-0.08462505,-0.13461021,-0.22398967,-0.54554937,-0.55158354,0.04581859,0.00804478,0,0,0.00107876,-0.00680633,0.00608803,-0.00218604,0,-0.14645846,0.07864555,0.01409462,-0.05872051,0.10039991,0.00502389,0.05600032,0,0,0,13.32524107,0},{4.73641097,-0.13559191,-0.21052661,-0.26384585,-0.25111362,-1.16217843,-0.9147421,0.26360728,0.14723186,0,0,-0.00254465,-0.00764856,-0.13104988,-0.0055835,0,-0.16058713,0.08013562,0.02380744,-0.60374567,-0.01169013,-0.01520593,0.07526727,0,0,0,12.85038567,0},{3.13651332,0.00329082,-0.02509546,-0.30019695,-0.23468171,-0.26955197,-0.37276674,0.09269372,0.05159871,0,0,-0.00032246,-0.00406909,-0.01180544,-0.00186415,0,-0.06531485,0.01983012,0.02412688,-0.0146537,0.06721147,-0.00767695,0.04712954,0,0,0,7.11804171,0}};

const cof4 NextStepCalcML::TF_L1_5YR ={{-3.100000,0,0,0.163000,0.147000,0.154000,-0.470000,0.119000,-0.168000,0,0,0,0.004190,0.027800,-0.000055,0,0.086300,-0.098900,0,-0.086300,0.042600,-0.014200,0.087600,0.110000,-0.044500,0.001660,3.370000,0},{1.820000,0,0,-0.375000,-0.050100,-0.635000,-0.612000,-0.035800,-0.090600,0,0,0,-0.004280,-0.048600,-0.002330,0,-0.136000,0.116000,0,-0.063000,0.063100,0.019100,0.091800,-0.082100,0.026500,0.115000,4.360000,0},{4.360000,0,0,-0.059500,-0.166000,-0.974000,-1.150000,0.300000,0.280000,0,0,0,-0.010900,-0.291000,-0.005050,0,-0.186000,-0.010600,0,-0.523000,0.026600,-0.003250,0.082400,-0.000455,0.003920,0.180000,17.700000,0},{3.950000,0,0,-0.253000,-0.126000,-0.330000,-0.425000,0.149000,0.075300,0,0,0,-0.003360,0.003880,-0.001830,0,-0.055700,0.006940,0,0.018100,0.067400,-0.000195,0.046700,0.038500,0.000918,0.181000,5.530000,0}};

const cof4 NextStepCalcML::TF_L1_6YR ={{-4.49567748,-0.3984106,-0.03324775,0.10312832,-0.27034137,0.5030595,-0.03943553,0.14945103,-0.20872828,-0.28460258,0,-0.00210931,-0.00714307,0.03758176,0.00404385,0,0.08558443,0.01107618,0.00047496,-0.04459522,0.06596296,0.0061417,0.11701474,0.12373413,-0},{3.19486783,0.06609578,-0.01047538,-0.60161646,-0.20719979,-0.23308351,-0.40576618,-0.04277912,-0.0465186,0.02588511,0,-0.00263566,-0.00407765,0.0835695,-0.00334244,0,-0.14200595,0.11250769,0.00772235,0.04956813,0.02664772,0.02746772,0.12188137,0.113598,0.12043717,0.23379332,-0.12551524,0},{4.71761414,0.13707827,-0.19031948,-0.51555173,-0.18886405,-0.67250799,-0.95383314,0.21142428,0.07034368,-0.06585559,0,-0.00287328,-0.01211362,-0.1670505,-0.00342173,0,-0.13704549,0.01655322,0.00040937,-0.31951747,-0.0012491,0.0044914,-0.0034286,0.01022013,-0.14824244,0.18608101,10.78878223,0},{4.75044564,0.09514553,-0.03627366,-0.4787368,-0.10954028,-0.28699056,-0.43532095,0.16346718,0.10820285,-0.04486491,0,-0.00247343,-0.00574417,-0.02568658,-0.00145206,0,-0.02953928,0.02218572,0.00206648,0.06364603,0.05587496,0.00276401,0.04098635,0.16481667,0.14343855,0.43849411,0.99941633,0}};

const cof4 NextStepCalcML::TF_L2_2YR ={{-0.46580599,0,0,0,0,0,0,-0.14494554,0.35417847,0.168847,0,0.01356875,0.00546611,0.54996921,-0.00233506,0,0.12991329,-0.21941291,0.01111379,-0.22179021,0,-0.00084268,-0.48826289,0.69959334,0.04525821,0.91875011,0,-1.25046291},{4.81647854,0,0,0,0,0,0,-0.36502346,-0.13324787,-0.32332086,0,-0.00527568,0.00009828,0.25613111,-0.00340791,0,0.20398367,-0.25159683,0.00865788,-0.22614563,0,0.00075667,-0.26265118,0.13537707,0.01461509,0.34570756,0,1.22446362},{9.68135462,0,0,0,0,0,0,-0.13972642,-0.07421567,-0.05709073,0,-0.00205013,-0.00395764,-0.12675063,-0.00761519,0,0.08999072,-0.21788204,-0.01555409,-1.31230932,0,0.12164984,-1.26861197,0.17539071,0.11468851,0.30807231,0,0.67174708},{8.25327872,0,0,0,0,0,0,-0.0719103,0.15208905,-0.18047054,0,-0.00024217,0.00302406,-0.04240401,-0.00604903,0,0.15443227,-0.19534249,0.01996846,-0.48823154,0,0.01513549,-0.52199522,0.4453982,0.25479048,0.69444362,0,0.41510832}};

const cof4 NextStepCalcML::TF_L2_3YR ={{-0.66706223,0,0,0.09238395,-0.69987734,-0.2358032,-0.47972826,0,0,0,0,0.01627559,0,0.1450965,-0.00087804,0,-0.19009568,0,0,-0.31667666,0.28057244,0.14975754,-0.93318001,-0.53669305,-0.44158015,-0.23797217,15.20143645,-1.85831155},{3.18595846,0,0,0.24228422,-1.72754653,-0.00110311,-0.20578892,0,0,0,0,0.01018918,0,-0.19675695,-0.00569855,0,-0.39892201,0,0,-0.20209501,0.19330993,0.1748941,-0.82922563,-0.20467997,0.13803819,0.2725742,41.68180199,-1.14790701},{6.57311551,0,0,-0.1225182,-0.97923551,-0.09557253,-1.05081426,0,0,0,0,0.01034998,0,-0.46082469,-0.00766302,0,-0.47273776,0,0,-1.3626317,0.1844442,0.14930295,-1.39706538,-0.18187196,0.20457355,0.18145665,44.16905543,-1.45030765},{7.32424224,0,0,-0.01709709,-1.1544283,-0.27013467,-0.62281942,0,0,0,0,0.01110629,0,-0.483686,-0.0068122,0,-0.38215695,0,0,-0.44135415,0.23837312,0.14126584,-1.13592419,-0.0930023,0.14034089,0.1757438,40.5010432,-1.59333787}};

const cof4 NextStepCalcML::TF_L2_4YR ={{-1.09339724,0,0,0.59021894,-1.86778853,0,0,0.91963872,0.35910846,0.02645201,0,0.01529452,-0.00312147,0,-0.00086564,0,-0.20155455,0,0,-0.26293719,0.18737412,0.09005426,-0.55194594,-0.37126627,-0.74044879,-0.71023913,0.260999235,-1.74048786},{0.41874417,0,0,0.56097513,-2.88562651,0,0,0.56698882,-0.0209294,-0.3344272,0,0.01223009,-0.00985835,0,-0.0029784,0,-0.36210237,0,0,-0.16679499,0.15649884,0.18470911,-0.7143597,-0.10094622,-0.38835918,-0.17258399,0.529481047,-1.18255441},{5.63424187,0,0,0.38309288,-1.46810107,0,0,0.74170196,0.2836947,-0.41740508,0,0.01355723,-0.0122211,0,-0.0075095,0,-0.39764703,0,0,-1.43173713,0.1068947,0.03784128,-0.870137,-0.2750781,-0.44152747,-0.39714085,0.539880794,-1.57114585},{6.45338884,0,0,0.33693558,-2.11304452,0,0,0.75583091,0.2685886,-0.44762516,0,0.01268816,-0.0096184,0,-0.00603352,0,-0.3402185,0,0,-0.41076382,0.12903751,0.12075335,-0.78874947,-0.13406132,-0.4483051,-0.29246189,0.511751262,-1.44924311}};

const cof4 NextStepCalcML::TF_L2_5YR ={{1.3619583,0,0,0,0,0.9931161,-0.4450689,0.9516892,0.692934,0.4185348,0,0,0,0,-0.0023518,0,-0.1884388,0,0,-0.1786146,0.1662326,0.1572484,-0.469501,0.1649048,0.5146738,0.7456074,0.206009716,0},{2.1070284,0,0,0,0,0.8981872,-0.9805155,0.359872,0.3307935,0.0280468,0,0,0,0,-0.0032225,0,-0.2310759,0,0,-0.0853182,0.093913,0.1619679,-0.4374202,0.3338753,0.7655342,0.638794,0.359284498,0},{7.6782586,0,0,0,0,0.4029523,-1.3877534,0.8379644,0.9699229,0.0563014,0,0,0,0,-0.0066208,0,-0.2819229,0,0,-1.2011321,0.0024302,0.1173422,-1.0649591,-0.1610996,0.0655487,0.0134488,0.367361137,0},{8.2180124,0,0,0,0,0.4332528,-1.3025212,0.5873013,0.6089902,-0.1564737,0,0,0,0,-0.0056232,0,-0.2063088,0,0,-0.3622886,0.0465179,0.1896511,-0.7496724,0.1561854,0.5220077,0.4599493,0.342662889,0}};

//member function to calculate next status based on simulation result
//call different set of coefficients based on LIEN, Status, Shock, prepayment incentive, NOTE TO BOB CHANGE etc. to full list of inputs
char NextStepCalcML::next_stg_c(LoanDef &loan){
    if(loan.get_STAT() == 'R'){
        if(loan.get_reo_rem()==0) return '0';
        return 'R';
    }

    if(loan.get_STAT() == '0'){
        cout << "should never be here\n";
        return '0';
    }
	/* reo is done by counting remaining term, prepay->prepay */
	bool check_cpr = false;
    //int num = 27;

	char stage = loan.get_STAT();

	int loan_age=loan.get_AGE();
    //vector<double> res(NUM_OF_TRANS_STATES, 0.);
	vector<double> mid; 
	vector<double> midx, midy; // store the prepays
	
	TransRateCalc getmid;

    double r = fast_rand();

	if (stage == 'C'){

		if(loan.get_LIEN()==1) {

			if(abs(loan.get_pmt_shock())>12) {		
				if(loan.get_deq_hist()>0) {
					if(loan.get_prep_inc()>0) {
						midx = getmid.calc_one(loan.res, P_L1_NSK_I_P);
					}
					else {
						midx = getmid.calc_one(loan.res, P_L1_NSK_NI_P);
					}
				}
				else {
					if(loan.get_prep_inc()>0) {
						midx = getmid.calc_one(loan.res, P_L1_NSK_I_NP);
					}
					else {
						midx = getmid.calc_one(loan.res, P_L1_NSK_NI_NP);
					}
				}
			}

			else {
				if(loan.get_deq_hist()>0) {
					if(loan.get_prep_inc()>0) {
						midx = getmid.calc_one(loan.res, P_L1_SK_I_P);
					}
					else {
						midx = getmid.calc_one(loan.res, P_L1_SK_NI_P);
					}
				}
				else {
					if(loan.get_prep_inc()>0) {
						midx = getmid.calc_one(loan.res, P_L1_SK_I_NP);
					}
					else {
						midx = getmid.calc_one(loan.res, P_L1_SK_NI_NP);
					}
				}
			}
		}
		
		else {
			midx.push_back(1.0);
			midx.push_back(0.0);
		}

		/*
		else {
			if(abs(loan.get_pmt_shock())>12) {		
				if(loan.get_deq_hist()>0) {
					if(loan.get_prep_inc()>0) {
						midx = getmid.calc_one(loan.res, P_L2_NSK_I_P);
					}
					else {
						midx = getmid.calc_one(loan.res, P_L2_NSK_NI_P);
					}
				}
				else {
					if(loan.get_prep_inc()>0) {
						midx = getmid.calc_one(loan.res, P_L2_NSK_I_NP);
					}
					else {
						midx = getmid.calc_one(loan.res, P_L2_NSK_NI_NP);;
					}
				}
			}
			else {
				if(loan.get_deq_hist()>0) {
					if(loan.get_prep_inc()>0) {
						midx = getmid.calc_one(loan.res, P_L2_SK_I_P);
					}
					else {
						midx = getmid.calc_one(loan.res, P_L2_SK_NI_P);
					}
				}
				else {
					if(loan.get_prep_inc()>0) {
						midx = getmid.calc_one(loan.res, P_L2_SK_I_NP);
					}
					else {
						midx = getmid.calc_one(loan.res, P_L2_SK_NI_NP);
					}
				}
			}
		}
		*/

        //midy.clear();

		/* for transition from current status, the coefficients are broken down 
		with lien position, delinquency history, loan age */
		if(loan.get_LIEN()==1) {

			if(loan.get_deq_hist()<3.1) {  // 3.1
				if(loan_age<25) {
					midy = getmid.calc_one(loan.res, NP_2YR);
				}
				else if(loan_age<37) {
					midy = getmid.calc_one(loan.res, NP_3YR);
				}
				else if(loan_age<49) {
					midy = getmid.calc_one(loan.res, NP_4YR);
				}
				else if(loan_age<61) {
					midy = getmid.calc_one(loan.res, NP_5YR);
				}
				else {
					midy = getmid.calc_one(loan.res, NP_6YR);
				}
			}
			else {
				if(loan_age<25) {
					midy = getmid.calc_one(loan.res, P_2YR);
				}
				else if(loan_age<37) {
					midy = getmid.calc_one(loan.res, P_3YR);
				}
				else if(loan_age<49) {
					midy = getmid.calc_one(loan.res, P_4YR);
				}
				else if(loan_age<61) {
					midy = getmid.calc_one(loan.res, P_5YR);
				}
				else {
					midy = getmid.calc_one(loan.res, P_6YR);
				}
			}

		}

		else {
			if(loan.get_deq_hist()<0.001) { //0.1
				if(loan_age<25) {
					midy = getmid.calc_one(loan.res, L2_NP_2YR);
				}
				else if(loan_age<37) {
					midy = getmid.calc_one(loan.res, L2_NP_3YR);
				}
				else if(loan_age<49) {
					midy = getmid.calc_one(loan.res, L2_NP_4YR);
				}
				else if(loan_age<61) {
					midy = getmid.calc_one(loan.res, L2_NP_5YR);
				}
				else {
					midy = getmid.calc_one(loan.res, L2_NP_6YR);
				}
			}
			else {
				if(loan_age<25) {
					midy = getmid.calc_one(loan.res, L2_P_2YR);
				}
				else if(loan_age<37) {
					midy = getmid.calc_one(loan.res, L2_P_3YR);
				}
				else if(loan_age<49) {
					midy = getmid.calc_one(loan.res, L2_P_4YR);
				}
				else if(loan_age<61) {
					midy = getmid.calc_one(loan.res, L2_P_5YR);
				}
				else {
					midy = getmid.calc_one(loan.res, L2_P_6YR);
				}
			}
		}
    
        if(check_cpr){
            if(midx[1] > -1){
                cout << loan.get_NAME() << "|";
        //cout << "midx1 is " << midx[1] << "\n";
                if(loan.get_LIEN()==1) {
                    if(abs(loan.get_pmt_shock())>12) {		
                        if(loan.get_deq_hist()>0) {
                            if(loan.get_prep_inc()>0) {
                                cout << "P_L1_NSK_I_P|";
                                for(size_t i =0;i != 28; ++i)
                                    cout << P_L1_NSK_I_P[i] << "|";;
                            }
                            else {
                                cout << "P_L1_NSK_NI_P|";
                                for(size_t i =0;i != 28; ++i)
                                    cout << P_L1_NSK_NI_P[i] << "|";
                            }
                        }
                        else {
                            if(loan.get_prep_inc()>0) {
                                cout << "P_L1_NSK_I_NP|";
                                for(size_t i =0;i != 28; ++i)
                                    cout << P_L1_NSK_I_NP[i] << "|";
                            }
                            else {
                                cout << "P_L1_NSK_NI_NP|";
                                for(size_t i =0;i != 28; ++i)
                                    cout << P_L1_NSK_NI_NP[i] << "|";
                            }
                        }
                    }

                    else {
                        if(loan.get_deq_hist()>0) {
                            if(loan.get_prep_inc()>0) {
                                cout << "P_L1_SK_I_P|";
                                for(size_t i =0;i != 28; ++i)
                                    cout << P_L1_SK_I_P[i] << "|";
                            }
                            else {
                                cout << "P_L1_SK_NI_P|";
                                for(size_t i =0;i != 28; ++i)
                                    cout << P_L1_SK_NI_P[i] << "|";
                            }
                        }
                        else {
                            if(loan.get_prep_inc()>0) {
                                cout << "P_L1_SK_I_NP|";
                                for(size_t i =0;i != 28; ++i)
                                    cout << P_L1_SK_I_NP[i] << "|";
                            }
                            else {
                                cout << "P_L1_SK_NI_NP|";
                                for(size_t i =0;i != 28; ++i)
                                    cout << P_L1_SK_NI_NP[i] << "|";
                            }
                        }
                    }
                }


                else {
                    if(abs(loan.get_pmt_shock())>12) {		
                        if(loan.get_deq_hist()>0) {
                            if(loan.get_prep_inc()>0) {
                                cout << "P_L2_NSK_I_P|";
                                for(size_t i =0;i != 28; ++i)
                                    cout << P_L2_NSK_I_P[i] << "|";
                            }
                            else {
                                cout << "P_L2_NSK_NI_P|";
                                for(size_t i =0;i != 28; ++i)
                                    cout << P_L2_NSK_NI_P[i] << "|";
                            }
                        }
                        else {
                            if(loan.get_prep_inc()>0) {
                                cout << "P_L2_NSK_I_NP|";
                                for(size_t i =0;i != 28; ++i)
                                    cout << P_L2_NSK_I_NP[i] << "|";
                            }
                            else {
                                cout << "P_L2_NSK_NI_NP|";
                                for(size_t i =0;i != 28; ++i)
                                    cout << P_L2_NSK_NI_NP[i] << "|";
                            }
                        }
                    }
                    else {
                        if(loan.get_deq_hist()>0) {
                            if(loan.get_prep_inc()>0) {
                                cout << "P_L2_SK_I_P|";
                                for(size_t i =0;i != 28; ++i)
                                    cout << P_L2_SK_I_P[i] << "|";
                            }
                            else {
                                cout << "P_L2_SK_NI_P|";
                                for(size_t i =0;i != 28; ++i)
                                    cout << P_L2_SK_NI_P[i] << "|";
                            }
                        }
                        else {
                            if(loan.get_prep_inc()>0) {
                                cout << "P_L2_SK_I_NP|";
                                for(size_t i =0;i != 28; ++i)
                                    cout << P_L2_SK_I_NP[i] << "|";
                            }
                            else {
                                cout << "P_L2_SK_NI_NP|";
                                for(size_t i =0;i != 28; ++i)
                                    cout << P_L2_SK_NI_NP[i] << "|";
                            }
                        }
                    }
                }

                cout << "\n" << loan.get_NAME() << "|LOANVEC|1|";
                for(size_t i =0;i != 27; ++i)
                    cout << loan.res[i] << "|";
                cout << midx[1] << "\n";
	
        //cout << "midy is " << midy[0] << ", " << midy[1] << "\n";
            }
        }

        mid = getmid.two_vec(midx, midy);

        //mid is pp, p3, pc
        if(r < mid[2]) return 'C';
        if(r < mid[1]+mid[2]) return '3';
        return '0';
	}

	/* for transition from 30 delinquent, the coefficients are broken down 
		with lien position, loan age */
	else if (stage=='3') {
		if(loan.get_LIEN()==1) {
			if(loan_age<25) {
				mid = getmid.calc_two(loan.res, T3_L1_2YR);
			}
			else if(loan_age<37) {
				mid = getmid.calc_two(loan.res, T3_L1_3YR);
			}
			else if(loan_age<49) {
				mid = getmid.calc_two(loan.res, T3_L1_4YR);
			}
			else if(loan_age<61) {
				mid = getmid.calc_two(loan.res, T3_L1_5YR);
			}
			else {
				mid = getmid.calc_two(loan.res, T3_L1_6YR);
			}
		}

		else {
			if(loan_age<25) {
				mid = getmid.calc_two(loan.res, T3_L2_2YR);
			}
			else if(loan_age<37) {
				mid = getmid.calc_two(loan.res, T3_L2_3YR);
			}
			else if(loan_age<49) {
				mid = getmid.calc_two(loan.res, T3_L2_4YR);
			}
			else{
				mid = getmid.calc_two(loan.res, T3_L2_5YR);
			}
		}


        //out 33 36 3c
        if(r < mid[2]) return 'C';
        if(r < mid[0]+mid[2]) return '3';
        return '6';
    }

		/* for transition from 60 delinquent, the coefficients are broken down 
		with lien position, loan age */
	else if (stage=='6') {
		if(loan.get_LIEN()==1) {
			if(loan_age<25) {
				mid = getmid.calc_four(loan.res, T6_L1_2YR);
			}
			else if(loan_age<37) {
				mid = getmid.calc_four(loan.res, T6_L1_3YR);
			}
			else if(loan_age<49) {
				mid = getmid.calc_four(loan.res, T6_L1_4YR);
			}
			else if(loan_age<61) {
				mid = getmid.calc_four(loan.res, T6_L1_5YR);
			}
			else {
				mid = getmid.calc_four(loan.res, T6_L1_6YR);
			}
		}
		
		else {
			if(loan_age<25) {
				mid = getmid.calc_four(loan.res, T6_L2_2YR);
			}
			else if(loan_age<37) {
				mid = getmid.calc_four(loan.res, T6_L2_3YR);
			}
			else if(loan_age<49) {
				mid = getmid.calc_four(loan.res, T6_L2_4YR);
			}
			else {
				mid = getmid.calc_four(loan.res, T6_L2_5YR);
			}
		}	

		// possible outcome 63 66 69 6c 6f
        if(r < mid[3]) return 'C';
        if(r < mid[3]+mid[0]) return '3';
        if(r < mid[3]+mid[0]+mid[1]) return '6';
        if(r < mid[3]+mid[0]+mid[1]+mid[2]) return '9';
        return 'F';
	}

	/* for transition from 90+ delinquent, the coefficients are broken down 
		with lien position, loan age */
	else if (stage=='9') {
		if(loan.get_LIEN()==1) {
			if(loan_age<25) {
				mid = getmid.calc_four(loan.res, T9_L1_2YR);
			}
			else if(loan_age<37) {
				mid = getmid.calc_four(loan.res, T9_L1_3YR);
			}
			else if(loan_age<49) {
				mid = getmid.calc_four(loan.res, T9_L1_4YR);
			}
			else if(loan_age<61) {
				mid = getmid.calc_four(loan.res, T9_L1_5YR);
			}
			else {
				mid = getmid.calc_four(loan.res, T9_L1_6YR);
			}
		}

		else {
			if(loan_age<25) {
				mid = getmid.calc_four(loan.res, T9_L2_2YR);
			}
			else if(loan_age<37) {
				mid = getmid.calc_four(loan.res, T9_L2_3YR);
			}
			else if(loan_age<49) {
				mid = getmid.calc_four(loan.res, T9_L2_4YR);
			}
			else {
				mid = getmid.calc_four(loan.res, T9_L2_5YR);
			}
		}	
		// possible output 90 96 99 9c 9f
        if(r < mid[3]) return 'C';
        if(r < mid[3]+mid[1]) return '6';
        if(r < mid[3]+mid[1]+mid[2]) return '9';
        if(r < mid[3]+mid[1]+mid[2]+mid[4]) return 'F';
        return '0';
	}

	/* for transition from foreclosure, the coefficients are broken down 
		with lien position, loan age */
    //else if (stage=='F') {
    else{
		if(loan.get_LIEN()==1) {
			if(loan_age<25) {
				mid = getmid.calc_four(loan.res, TF_L1_2YR);
			}
			else if(loan_age<37) {
				mid = getmid.calc_four(loan.res, TF_L1_3YR);
			}
			else if(loan_age<49) {
				mid = getmid.calc_four(loan.res, TF_L1_4YR);
			}
			else if(loan_age<61) {
				mid = getmid.calc_four(loan.res, TF_L1_5YR);
			}
			else {
				mid = getmid.calc_four(loan.res, TF_L1_6YR);
			}
		}

		else {
			if(loan_age<25) {
				mid = getmid.calc_four(loan.res, TF_L2_2YR);
			}
			else if(loan_age<37) {
				mid = getmid.calc_four(loan.res, TF_L2_3YR);
			}
			else if(loan_age<49) {
				mid = getmid.calc_four(loan.res, TF_L2_4YR);
			}
			else {
				mid = getmid.calc_four(loan.res, TF_L2_5YR);
			}
		}

		// possible output f0 f9 fc ff fr
        if(r < mid[2]) return 'C';
        if(r < mid[2]+mid[1]) return '9';
        if(r < mid[2]+mid[1]+mid[3]) return 'F';
        if(r < mid[2]+mid[1]+mid[3]+0.75*mid[4]) return 'R';
        return '0';
        /*
		res[CURRENT] = mid[2]; 
		res[NINETY] = mid[1];
		res[FORECLOSURE] = mid[3];
		res[REO] = mid[4]*(1-0.25); 
		res[PP] = mid[0]+mid[4]*0.25; 
        */
    }
}
